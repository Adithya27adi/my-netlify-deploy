{% extends 'base.html' %}

{% block title %}Your Card Orders - RTO Manager{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="text-center mb-5">
        <h2 class="fw-bold display-6">ðŸ“‡ Your Card Orders</h2>
        <p class="text-muted">Track your PVC and NFC card orders in one place</p>
    </div>

    <div id="orders-container" class="row g-4 justify-content-center">
        {% for order in user_orders %}
        <div class="col-12 col-sm-6 col-lg-4 order-card-wrapper {% if forloop.counter > 6 %}d-none{% endif %}">
            <div class="card order-card shadow-sm border-0 rounded-4 overflow-hidden h-100">
                {% if order.order_type == 'pvc_card' %}
                <div class="order-card-header bg-pvc-card position-relative">
                    <div class="icon-circle">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <h4 class="fw-bold mt-2 text-white">PVC Smart Card</h4>
                    <p class="text-white-50 small">Physical card + QR code</p>
                </div>
                {% elif order.order_type == 'nfc_card' %}
                <div class="order-card-header bg-nfc-card position-relative">
                    <div class="icon-circle">
                        <i class="fas fa-wifi"></i>
                    </div>
                    <h4 class="fw-bold mt-2 text-white">NFC Smart Card</h4>
                    <p class="text-white-50 small">Tap to view technology</p>
                </div>
                {% endif %}

                <div class="card-body bg-white">
                    <ul class="list-unstyled mb-0">
                        <li class="mb-2"><strong>Order:</strong>
                             <span class="badge bg-success">Recived</span>
                        </li>
                        <li class="mb-2"><strong>Delivery:</strong>
                            {% if order.order_type == 'pvc_card' %}
                                Within 7 working days
                            {% elif order.order_type == 'nfc_card' %}
                                Within 4-5 working days
                            {% endif %}
                        </li>
                        <li><strong>Order Date:</strong> {{ order.created_at|date:"F d, Y" }}</li>
                    </ul>
                </div>

                <div class="card-footer bg-light border-0 text-center py-3">
                    <a href="{% url 'core:order_detail' order_id=order.order_id %}" 
                       class="btn btn-outline-primary btn-sm fw-semibold rounded-pill px-4">
                        View Details
                    </a>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center py-5">
            <i class="fas fa-credit-card text-muted fa-3x mb-3"></i>
            <h5 class="text-muted">You have not ordered any cards yet.</h5>
        </div>
        {% endfor %}
    </div>

    {% if user_orders|length > 6 %}
    <div class="text-center mt-4">
        <button id="showMoreBtn" class="btn btn-primary fw-semibold px-5 py-2 rounded-pill shadow-sm">
            Show More
        </button>
    </div>
    {% endif %}
</div>

<style>
/* === General Card Styling === */
.order-card {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.order-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.1);
}

/* === Header Styles === */
.order-card-header {
    padding: 2rem 1rem;
    text-align: center;
}
.icon-circle {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: rgba(255,255,255,0.15);
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 0 auto;
}
.icon-circle i {
    font-size: 28px;
    color: #fff;
}
.bg-pvc-card {
    background: linear-gradient(135deg, #6c63ff, #5ab9f2);
}
.bg-nfc-card {
    background: linear-gradient(135deg, #232526, #414345);
}

/* === Badge Styling === */
.most-popular {
    top: 12px;
    left: 50%;
    transform: translateX(-50%);
    background: #ffde59;
    color: #262626;
    font-weight: 600;
    border-radius: 12px;
    padding: 0.35rem 1rem;
    font-size: 0.85rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

/* === Responsive === */
@media (max-width: 992px) {
    .order-card { max-width: 100%; }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const showMoreBtn = document.getElementById('showMoreBtn');
    if (showMoreBtn) {
        showMoreBtn.addEventListener('click', function () {
            document.querySelectorAll('.order-card-wrapper.d-none').forEach(card => {
                card.classList.remove('d-none');
            });
            showMoreBtn.style.display = 'none';
        });
    }
});
</script>
{% endblock %}
